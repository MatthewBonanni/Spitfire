
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>3. Solving Combustion Problems in Spitfire &#8212; Spitfire 1.0 documentation</title>
    <link rel="stylesheet" href="_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="5. spitfire" href="modules.html" />
    <link rel="prev" title="2. Time Integration" href="timeintegration.html" /> 
  </head><body>
      <div class="header" role="banner"><h1 class="heading"><a href="index.html">
          <span>Spitfire 1.0 documentation</span></a></h1>
        <h2 class="heading"><span>3. Solving Combustion Problems in Spitfire</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        «&#160;&#160;<a href="timeintegration.html">2. Time Integration</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="modules.html">5. spitfire</a>&#160;&#160;»
        </p>

      </div>
      <div class="content" role="main">
        
        
  <div class="section" id="solving-combustion-problems-in-spitfire">
<h1>3. Solving Combustion Problems in Spitfire<a class="headerlink" href="#solving-combustion-problems-in-spitfire" title="Permalink to this headline">¶</a></h1>
<p>This section describes setting up homogeneous reactors and non-premixed flamelets and computing steady and unsteady solutions,
and the following section discusses relevant combustion theory.</p>
<div class="section" id="chemical-mechanisms">
<h2>3.1. Chemical Mechanisms<a class="headerlink" href="#chemical-mechanisms" title="Permalink to this headline">¶</a></h2>
<p>The first step to solving any combustion problem in Spitfire is setting up the chemical mechanism,
which contains all of the necessary information regarding thermodynamics and chemical kinetics.
Spitfire uses the Python interface of <a class="reference external" href="https://cantera.org/">cantera</a> as well as the cantera XML description of chemical mechanisms.</p>
<p>Having obtained a cantera XML file for your chemical mechanism,
next import the <code class="docutils literal notranslate"><span class="pre">ChemicalMechanismSpec</span></code> class and construct an instance of it
with the file path to the XML and the species group.
For example, as seen in the demonstration script, <code class="docutils literal notranslate"><span class="pre">spitfire/demo/reactors/docs-simple-example-1.py</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">spitfire</span> <span class="k">import</span> <span class="n">ChemicalMechanismSpec</span>
<span class="n">sm</span> <span class="o">=</span> <span class="n">ChemicalMechanismSpec</span><span class="p">(</span><span class="n">cantera_xml</span><span class="o">=</span><span class="s1">&#39;mechanisms/h2-burke.xml&#39;</span><span class="p">,</span> <span class="n">group_name</span><span class="o">=</span><span class="s1">&#39;h2-burke&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="streams-mixing">
<h2>3.2. Streams &amp; Mixing<a class="headerlink" href="#streams-mixing" title="Permalink to this headline">¶</a></h2>
<p>Having constructed a <code class="docutils literal notranslate"><span class="pre">ChemicalMechanismSpec</span></code> instance, we need to specify thermochemical properties of mixtures.
In Spitfire this is accomplished with <em>streams</em> created with a <code class="docutils literal notranslate"><span class="pre">ChemicalMechanismSpec</span></code> instance.
For example, a mixture of pure Hydrogen is created and its temperature and pressure set with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h2</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">stream</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;H2:1&#39;</span><span class="p">)</span>
<span class="n">h2</span><span class="o">.</span><span class="n">TP</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">101325</span>
</pre></div>
</div>
<p>To specify the temperature and pressure at the same time as the composition (mole fractions here), the stream could be created with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h2</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">stream</span><span class="p">(</span><span class="s1">&#39;TPX&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">101325</span><span class="p">,</span> <span class="s1">&#39;H2:1&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>Streams are instances of the <code class="docutils literal notranslate"><span class="pre">Quantity</span></code> class in Cantera’s Python interface.
The <code class="docutils literal notranslate"><span class="pre">stream</span></code> method on <code class="docutils literal notranslate"><span class="pre">ChemicalMechanismSpec</span></code> can be given temperature, pressure, and composition or any combination Cantera allows.
See <a class="reference external" href="https://www.cantera.org/docs/sphinx/html/cython/importing.html#cantera.Quantity">Cantera documentation for options</a> regarding the construction of <code class="docutils literal notranslate"><span class="pre">Quantity</span></code> instances and setting/getting thermochemical properties.</p>
<p>For convenience, Spitfire makes it easy to create a stream of air at standard temperature and pressure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">air</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">stream</span><span class="p">(</span><span class="n">stp_air</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>New streams can be composed by mixing existing streams.
Mixing can be done on a mass or mole basis, isobarically or isometrically, to attain a particular equivalence ratio or mixture fraction, etc.</p>
<p>To mix two streams, say, one unit mass of <code class="docutils literal notranslate"><span class="pre">h2</span></code> and two unit masses of <code class="docutils literal notranslate"><span class="pre">air</span></code>, at constant pressure, call:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mix</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">mix_streams</span><span class="p">([(</span><span class="n">h2</span><span class="p">,</span> <span class="mf">1.</span><span class="p">),</span> <span class="p">(</span><span class="n">air</span><span class="p">,</span> <span class="mf">2.</span><span class="p">)],</span> <span class="s1">&#39;mass&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>To mix by mole at constant energy and volume (thus pressurizing the mixture):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mix2</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">mix_streams</span><span class="p">([(</span><span class="n">h2</span><span class="p">,</span> <span class="mf">1.</span><span class="p">),</span> <span class="p">(</span><span class="n">air</span><span class="p">,</span> <span class="mf">2.</span><span class="p">)],</span> <span class="s1">&#39;mole&#39;</span><span class="p">,</span> <span class="s1">&#39;UV&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Streams can be mixed in additional ways which are discussed in the following sections.</p>
</div>
<div class="section" id="homogeneous-reactors">
<h2>3.3. Homogeneous Reactors<a class="headerlink" href="#homogeneous-reactors" title="Permalink to this headline">¶</a></h2>
<div class="section" id="a-simple-autoignition-example">
<h3>3.3.1. A simple autoignition example<a class="headerlink" href="#a-simple-autoignition-example" title="Permalink to this headline">¶</a></h3>
<p>Starting from the point of constructing streams for air and fuel, we can mix them by specifying an equivalence ratio, <span class="math notranslate nohighlight">\(\phi\)</span>.
The <a class="reference external" href="https://en.wikipedia.org/wiki/Air%E2%80%93fuel_ratio#Fuel%E2%80%93air_equivalence_ratio_(%CF%95)">equivalence ratio</a> is the actual fuel-to-oxidizer ratio divided by the stoichiometric value.
With the <code class="docutils literal notranslate"><span class="pre">h2</span></code> and <code class="docutils literal notranslate"><span class="pre">air</span></code> streams, setting it to one yields a stoichiometric mixture of hydrogen and air,
meaning there is just the right amount of oxygen to burn all of the fuel in an ideal combustion reaction:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mix</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">mix_for_equivalence_ratio</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">h2</span><span class="p">,</span> <span class="n">air</span><span class="p">)</span>
</pre></div>
</div>
<p>The equivalence ratio varies from zero to infinity, with lean (too much oxygen) and rich (too much fuel) mixtures below and above one, respectively.
The <em>normalized</em> equivalence ratio, <span class="math notranslate nohighlight">\(\Phi=\phi/(\phi+1)\)</span>, however, varies more nicely from zero to one, and stoichiometric mixtures correspond to <span class="math notranslate nohighlight">\(\phi=1\)</span> and <span class="math notranslate nohighlight">\(\Phi=0.5\)</span>.
As it may be more convenient in some cases, the normalized equivalence ratio can also be used for mixing fuel and air:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mix</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">mix_for_normalized_equivalence_ratio</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">h2</span><span class="p">,</span> <span class="n">air</span><span class="p">)</span>
</pre></div>
</div>
<p>The temperature and pressure of the fuel-air blend can then be set with <code class="docutils literal notranslate"><span class="pre">mix.TP</span> <span class="pre">=</span> <span class="pre">1200,</span> <span class="pre">101325</span></code>.</p>
<p>Now we are ready to fill a reactor with this mixture and simulate its evolution.
First, build a homogeneous reactor that holds a constant pressure (isobaric), has impermeable (no mass flow - closed) and adiabatic (no heat flow) walls:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">spitfire</span> <span class="k">import</span> <span class="n">HomogeneousReactor</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">HomogeneousReactor</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span> <span class="n">mix</span><span class="p">,</span>
                       <span class="n">configuration</span><span class="o">=</span><span class="s1">&#39;isobaric&#39;</span><span class="p">,</span>
                       <span class="n">heat_transfer</span><span class="o">=</span><span class="s1">&#39;adiabatic&#39;</span><span class="p">,</span>
                       <span class="n">mass_transfer</span><span class="o">=</span><span class="s1">&#39;closed&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now to run a simple autoignition simulation and plot the temperature history along with several species mass fractions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">r</span><span class="o">.</span><span class="n">integrate_to_steady_after_ignition</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;H2&#39;</span><span class="p">,</span> <span class="s1">&#39;O2&#39;</span><span class="p">,</span> <span class="s1">&#39;H2O&#39;</span><span class="p">,</span> <span class="s1">&#39;OH&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>Adding the <code class="docutils literal notranslate"><span class="pre">plot</span></code> argument shows the temperature evolution in the top panel and species mass fractions in the bottom panel, as in Figure <a class="reference internal" href="#figure-simple-example-easyplot"><span class="std std-numref">Fig. 3.1</span></a>.
The occurence of ignition at around 0.05 milliseconds can be seen in the sudden temperature spike, consumption of hydrogen and oxygen, and production of water.
Observe that the hydrogen radical, H, a major chain carrying species, is produced prior to ignition and consumed afterwards, with its mass fraction peaking just at the onset of the temperature spike.
The ignition delay may be printed with the following command, <code class="docutils literal notranslate"><span class="pre">print('Ignition</span> <span class="pre">delay:</span> <span class="pre">{:.1f}</span> <span class="pre">us'.format(r.ignition_delay()</span> <span class="pre">*</span> <span class="pre">1.e6))</span></code>.
The precise number is 51.7 microseconds, matching our estimate of 0.05 milliseconds from the plot.
This simple tutorial can be run in total with the demonstration script, <code class="docutils literal notranslate"><span class="pre">spitfire/demo/reactors/docs-simple-example-1.py</span></code>.
This script is reproduced here as a summary:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">spitfire</span> <span class="k">import</span> <span class="n">ChemicalMechanismSpec</span><span class="p">,</span> <span class="n">HomogeneousReactor</span>

<span class="n">sm</span> <span class="o">=</span> <span class="n">ChemicalMechanismSpec</span><span class="p">(</span><span class="n">cantera_xml</span><span class="o">=</span><span class="s1">&#39;mechanisms/h2-burke.xml&#39;</span><span class="p">,</span> <span class="n">group_name</span><span class="o">=</span><span class="s1">&#39;h2-burke&#39;</span><span class="p">)</span>

<span class="n">h2</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">stream</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;H2:1&#39;</span><span class="p">)</span>
<span class="n">air</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">stream</span><span class="p">(</span><span class="n">stp_air</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">mix</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">mix_for_equivalence_ratio</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">h2</span><span class="p">,</span> <span class="n">air</span><span class="p">)</span>
<span class="n">mix</span><span class="o">.</span><span class="n">TP</span> <span class="o">=</span> <span class="mi">1200</span><span class="p">,</span> <span class="mi">101325</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">HomogeneousReactor</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span> <span class="n">mix</span><span class="p">,</span>
                       <span class="n">configuration</span><span class="o">=</span><span class="s1">&#39;isobaric&#39;</span><span class="p">,</span>
                       <span class="n">heat_transfer</span><span class="o">=</span><span class="s1">&#39;adiabatic&#39;</span><span class="p">,</span>
                       <span class="n">mass_transfer</span><span class="o">=</span><span class="s1">&#39;closed&#39;</span><span class="p">)</span>

<span class="n">r</span><span class="o">.</span><span class="n">integrate_to_steady_after_ignition</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;H2&#39;</span><span class="p">,</span> <span class="s1">&#39;O2&#39;</span><span class="p">,</span> <span class="s1">&#39;H2O&#39;</span><span class="p">,</span> <span class="s1">&#39;OH&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ignition delay: </span><span class="si">{:.1f}</span><span class="s1"> us&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">ignition_delay</span><span class="p">()</span> <span class="o">*</span> <span class="mf">1.e6</span><span class="p">))</span>
</pre></div>
</div>
<div class="align-center figure" id="id6">
<span id="figure-simple-example-easyplot"></span><a class="reference internal image-reference" href="_images/simple_example_isobaric_adiabatic_closed_plot.png"><img alt="_images/simple_example_isobaric_adiabatic_closed_plot.png" src="_images/simple_example_isobaric_adiabatic_closed_plot.png" style="width: 640px; height: 480px;" /></a>
<p class="caption"><span class="caption-number">Fig. 3.1 </span><span class="caption-text">Example figure produced by <code class="docutils literal notranslate"><span class="pre">r.integrate_to_steady_after_ignition(plot=['H2',</span> <span class="pre">'O2',</span> <span class="pre">'H2O',</span> <span class="pre">'OH',</span> <span class="pre">'H'])</span></code>.</span><a class="headerlink" href="#id6" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="in-situ-processing-and-analysis">
<h3>3.3.2. In-situ processing and analysis<a class="headerlink" href="#in-situ-processing-and-analysis" title="Permalink to this headline">¶</a></h3>
<p>In the previous example we constructed a reactor and observed its evolution, quickly obtaining a plot of temperature and species mass fraction evolution.
To do more detailed analysis, we’ll need to save state variables such as temperature and mass fractions for later use.
Start this next example in the same way, blending fuel and air streams and then using the mixture to construct a homogeneous reactor:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">spitfire</span> <span class="k">import</span> <span class="n">ChemicalMechanismSpec</span><span class="p">,</span> <span class="n">HomogeneousReactor</span>

<span class="n">sm</span> <span class="o">=</span> <span class="n">ChemicalMechanismSpec</span><span class="p">(</span><span class="n">cantera_xml</span><span class="o">=</span><span class="s1">&#39;mechanisms/h2-burke.xml&#39;</span><span class="p">,</span> <span class="n">group_name</span><span class="o">=</span><span class="s1">&#39;h2-burke&#39;</span><span class="p">)</span>

<span class="n">h2</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">stream</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;H2:1&#39;</span><span class="p">)</span>
<span class="n">air</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">stream</span><span class="p">(</span><span class="n">stp_air</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">mix</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">mix_for_equivalence_ratio</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">h2</span><span class="p">,</span> <span class="n">air</span><span class="p">)</span>
<span class="n">mix</span><span class="o">.</span><span class="n">TP</span> <span class="o">=</span> <span class="mi">1200</span><span class="p">,</span> <span class="mi">101325</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">HomogeneousReactor</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span> <span class="n">mix</span><span class="p">,</span>
                       <span class="n">configuration</span><span class="o">=</span><span class="s1">&#39;isobaric&#39;</span><span class="p">,</span>
                       <span class="n">heat_transfer</span><span class="o">=</span><span class="s1">&#39;adiabatic&#39;</span><span class="p">,</span>
                       <span class="n">mass_transfer</span><span class="o">=</span><span class="s1">&#39;closed&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This time, before integrating the reactor to a steady state, we will tell Spitfire to save data.
We will save the temperature, mass fractions, and species net production rates.
This is done with the <code class="docutils literal notranslate"><span class="pre">insitu_process_quantity</span></code> method, which allows us to tell Spitfire to compute thermochemical quantities <em>in situ</em> during the simulation.
After integration, we can obtain the saved quantities with the <code class="docutils literal notranslate"><span class="pre">trajectory_data</span></code> method.
To plot quantities over simulation time, we can use <code class="docutils literal notranslate"><span class="pre">t</span> <span class="pre">=</span> <span class="pre">r.solution_times</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">r</span><span class="o">.</span><span class="n">insitu_process_quantity</span><span class="p">([</span><span class="s1">&#39;temperature&#39;</span><span class="p">,</span> <span class="s1">&#39;mass fractions&#39;</span><span class="p">,</span> <span class="s1">&#39;production rates&#39;</span><span class="p">])</span>

<span class="n">r</span><span class="o">.</span><span class="n">integrate_to_steady_after_ignition</span><span class="p">()</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">solution_times</span> <span class="o">*</span> <span class="mf">1.e6</span>  <span class="c1"># scale to microseconds</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">trajectory_data</span><span class="p">(</span><span class="s1">&#39;temperature&#39;</span><span class="p">)</span>
<span class="n">yH</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">trajectory_data</span><span class="p">(</span><span class="s1">&#39;mass fraction H&#39;</span><span class="p">)</span>
<span class="n">wH</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">trajectory_data</span><span class="p">(</span><span class="s1">&#39;production rate H&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Importing <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">matplotlib.pyplot</span> <span class="pre">as</span> <span class="pre">plt</span></code>, we can then plot, for example, the production rate of the hydrogen radical over the reactor temperature.
This produces Figure <a class="reference internal" href="#figure-simple-example-prodrate-over-t"><span class="std std-numref">Fig. 3.2</span></a>.
This figure shows that the peak production rate of hydrogen radical occurs at around 200 K above the initial temperature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">wH</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;T (K)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;prod. rate H (kg/m3/s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="align-center figure" id="id7">
<span id="figure-simple-example-prodrate-over-t"></span><a class="reference internal image-reference" href="_images/simple_example_isobaric_adiabatic_closed_wHoverT.png"><img alt="_images/simple_example_isobaric_adiabatic_closed_wHoverT.png" src="_images/simple_example_isobaric_adiabatic_closed_wHoverT.png" style="width: 640px; height: 480px;" /></a>
<p class="caption"><span class="caption-number">Fig. 3.2 </span><span class="caption-text">Net production rate of hydrogen radical over the reactor temperature in an isobaric, adiabatic, closed autoignition simulation.</span><a class="headerlink" href="#id7" title="Permalink to this image">¶</a></p>
<div class="legend">
<p>A number of quantities may be computed <em>in situ</em> with the <code class="docutils literal notranslate"><span class="pre">insitu_process_quantity</span></code> method using either cantera or Griffon.
These are listed below.</p>
</div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'temperature'</span></code>: the reactor temperature</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'pressure'</span></code>: the reactor pressure</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'density'</span></code>: the mass density of the mixture</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'mass</span> <span class="pre">fractions'</span></code>: species mass fractions - obtain a particular species value with <code class="docutils literal notranslate"><span class="pre">'mass</span> <span class="pre">fraction</span> <span class="pre">A'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'mole</span> <span class="pre">fractions'</span></code>: species mole fractions - obtain a particular species value with <code class="docutils literal notranslate"><span class="pre">'mole</span> <span class="pre">fraction</span> <span class="pre">A'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'energy'</span></code>: the specific energy of the mixture</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'enthalpy'</span></code>: the specific enthalpy of the mixture</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'heat</span> <span class="pre">capacity</span> <span class="pre">cv'</span></code>: the specific constant-volume heat capacity of the mixture</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'heat</span> <span class="pre">capacity</span> <span class="pre">cp'</span></code>: the specific constant-pressure heat capacity of the mixture</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'production</span> <span class="pre">rates'</span></code>: species net mass production rates - obtain a particular species value with <code class="docutils literal notranslate"><span class="pre">'production</span> <span class="pre">rate</span> <span class="pre">A'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'heat</span> <span class="pre">release</span> <span class="pre">rate'</span></code>: chemical right-hand side component of the temperature equation. Energy-based for isochoric reactors, enthalpy-based for isobaric. Scaled by the appropriate volumetric heat capacity.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'eigenvalues'</span></code>: the full set of eigenvalues of the Jacobian matrix of the chemical source terms</p></li>
</ul>
<p>There are two other types of quantities that can be processed <em>in situ</em>.
First, one may calculate any quantity computable by the cantera gas phase - see <a class="reference external" href="https://www.cantera.org/docs/sphinx/html/cython/importing.html#cantera.Quantity">Cantera documentation for options</a>.
For instance, <code class="docutils literal notranslate"><span class="pre">r.insitu_process_cantera_method('cp_mass')</span></code> will save the result of the <code class="docutils literal notranslate"><span class="pre">cp_mass</span></code> method (which computes the specific heat capacity at constant pressure) at each state to the <code class="docutils literal notranslate"><span class="pre">'cp_mass'</span></code> label.
Any label may be specified as in <code class="docutils literal notranslate"><span class="pre">r.insitu_process_cantera_method(label='cpm',</span> <span class="pre">method='cp_mass')</span></code>.
This triggers calculation of <code class="docutils literal notranslate"><span class="pre">cp_mass</span></code> at every step and saves the data to the label, <code class="docutils literal notranslate"><span class="pre">'cpm'</span></code>.
In addition to simple scalar methods such as <code class="docutils literal notranslate"><span class="pre">cp_mass</span></code>, one can compute particular elements of vector quantities such as elementary reaction rates.
The line, <code class="docutils literal notranslate"><span class="pre">r.insitu_process_cantera_method(label='qCB',</span> <span class="pre">method='net_rates_of_progress',</span> <span class="pre">index=0)</span></code> will save the zeroth (first…) element of the vector computed by the <code class="docutils literal notranslate"><span class="pre">net_rates_of_progress</span></code> cantera method, and label it <code class="docutils literal notranslate"><span class="pre">qCB</span></code>.
For vectors of species quantities, the <code class="docutils literal notranslate"><span class="pre">index</span></code> argument can be the species’ name, such as in <code class="docutils literal notranslate"><span class="pre">r.insitu_process_cantera_method(label='cH',</span> <span class="pre">method='concentrations',</span> <span class="pre">index='H')</span></code>, which computes the molar concentration of species H.
Here are all four examples of general cantera-based processing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">r</span><span class="o">.</span><span class="n">insitu_process_cantera_method</span><span class="p">(</span><span class="s1">&#39;cp_mass&#39;</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">insitu_process_cantera_method</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;cpm&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cp_mass&#39;</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">insitu_process_cantera_method</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;qCB&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;net_rates_of_progress&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">insitu_process_cantera_method</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;cH&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;concentrations&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s1">&#39;H&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>And this code plots the rate of the chain-branching reaction, <code class="docutils literal notranslate"><span class="pre">H</span> <span class="pre">+</span> <span class="pre">O2</span> <span class="pre">&lt;-&gt;</span> <span class="pre">O</span> <span class="pre">+</span> <span class="pre">OH</span></code>, over time along with temperature in two panels.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">qCB</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;net rate (mol/m3/s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;H + O2 &lt;-&gt; O + OH&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t (us)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;T (K)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>The final type of <em>in situ</em> processing available is chemical explosive mode analysis (CEMA).
To trigger CEMA, call <code class="docutils literal notranslate"><span class="pre">r.insitu_process_cema()</span></code>.
There are several additional arguments that enable advanced analysis but we do not cover them here.
Calling <code class="docutils literal notranslate"><span class="pre">r.insitu_process_cema()</span></code> without any arguments triggers only the most basic technique of CEMA, which is to compute the ‘explosive eigenvalue’.
The explosive eigenvalue may be retrieved with ‘’r.trajectory_data(‘cema-lexp1’)’’.
See the demonstration script, <code class="docutils literal notranslate"><span class="pre">spitfire/demo/reactors/docs-example-2.py</span></code>, for more details and several plots.</p>
</div>
<div class="section" id="ignition-delay-calculations">
<h3>3.3.3. Ignition delay calculations<a class="headerlink" href="#ignition-delay-calculations" title="Permalink to this headline">¶</a></h3>
<p>A common task of combustion codes is to compute the ignition delay - how long it takes a mixture to ignite.
Spitfire’s reactor class makes this straightforward with the <code class="docutils literal notranslate"><span class="pre">compute_ignition_delay()</span></code> method.
See the following demonstration scripts in the <code class="docutils literal notranslate"><span class="pre">spitfire/demo/reactors/</span></code> directory for examples of computing ignition delays across ranges of temperature, pressure, mechanism, etc.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">spitfire/demo/reactors/ignition-delay-profiles-methane-mechanism-comparison.py</span></code>: compares the dependence of ignition delay on temperature for four mechanisms of methane combustion</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ignition-delay-profiles-DME-negative-temp-coeff.py</span></code>: demonstrates negative temperature coefficient (NTC) behavior of dimethyl ether (DME) mixtures and the dependency of NTC strength on pressure, as in Figure <a class="reference internal" href="#figure-dme-ntc-curves"><span class="std std-numref">Fig. 3.3</span></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ignition-delay-profiles-biodiesel-negative-temp-coeff.py</span></code>: performs a similar analysis to the DME case for biodiesel mixtures</p></li>
</ul>
<div class="align-center figure" id="id8">
<span id="figure-dme-ntc-curves"></span><a class="reference internal image-reference" href="_images/dme_ntc_curves.png"><img alt="_images/dme_ntc_curves.png" src="_images/dme_ntc_curves.png" style="width: 640px; height: 480px;" /></a>
<p class="caption"><span class="caption-number">Fig. 3.3 </span><span class="caption-text">Ignition delay curves of dimethyl ether mixtures for a number of pressures, demonstrating both the negative temperature coefficient behavior and its sensitivity to pressure</span><a class="headerlink" href="#id8" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="computing-ignition-extinction-curves">
<h3>3.3.4. Computing ignition-extinction curves<a class="headerlink" href="#computing-ignition-extinction-curves" title="Permalink to this headline">¶</a></h3>
<p>Another common task is to assess the presence of multiple steady states along ignition-extinction curves.
In the following demonstration scripts we build adiabatic reactors with mass flow at varying mixing (residence) times.
By increasing the mixing time from zero to infinity and computing the steady state temperature along the way, we compute the ignition branch.
Reversing the direction gives the extinction branch.
The scripts below show how one can compute ignition-extinction curves with Spitfire.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">spitfire/demo/reactors/ignext-hydrogen-mechanism-comparison.py</span></code>: compares ignition-extinction curves of three hydrogen mechanisms</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">spitfire/demo/reactors/ignext-ethylene-mechanism-comparison.py</span></code>: compares ignition-extinction curves of three ethylene mechanisms</p></li>
</ul>
</div>
<div class="section" id="time-dependent-parameters">
<h3>3.3.5. Time-dependent parameters<a class="headerlink" href="#time-dependent-parameters" title="Permalink to this headline">¶</a></h3>
<p>In the ignition-extinction demonstration scripts we build reactors with constant parameters (e.g. mixing time, feed temperature).
It is simple to specify the reactor parameters as functions of time.
Instead of providing a value for a parameter, provide a callable object such as a function, lambda, or class with the <code class="docutils literal notranslate"><span class="pre">__call__</span></code> method defined (note that the first argument in the function must be time, and only one argument is given).
For example, the <code class="docutils literal notranslate"><span class="pre">spitfire/demo/reactors/open-reactor-oscillatory-feed-temperature.py</span></code> script specifies the feed temperature as a sine wave of time with a lambda.
This slow oscillation of the feed temperature causes the reactor to periodically ignite and extinguish as shown in Figure <a class="reference internal" href="#figure-oscillating-feed-temperature"><span class="std std-numref">Fig. 3.4</span></a>.
Also note that in this script we do not compute a steady solution, instead using the <code class="docutils literal notranslate"><span class="pre">integrate_to_time</span></code> method of the reactor to integrate only until reaching a specified simulation time.</p>
<div class="align-center figure" id="id9">
<span id="figure-oscillating-feed-temperature"></span><a class="reference internal image-reference" href="_images/oscillatory_feed_temp_example.png"><img alt="_images/oscillatory_feed_temp_example.png" src="_images/oscillatory_feed_temp_example.png" style="width: 640px; height: 480px;" /></a>
<p class="caption"><span class="caption-number">Fig. 3.4 </span><span class="caption-text">Periodic ignition and extinction in a reactor due to slow oscillation of the feed stream temperature</span><a class="headerlink" href="#id9" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="reactor-types">
<h3>3.3.6. Reactor types<a class="headerlink" href="#reactor-types" title="Permalink to this headline">¶</a></h3>
<p>The demonstration scripts in <code class="docutils literal notranslate"><span class="pre">spitfire/demo/reactors/</span></code> that haven’t been covered in previous sections exist to showcase some of the reactor types available in Spitfire.
Spitfire provides three types of specifications and twelve types of reactors in total:</p>
<ul class="simple">
<li><p><strong>configuration</strong>: whether the reactor is isobaric (constant pressure) or isochoric (constant volume)</p></li>
<li><p><strong>heat_transfer</strong>: whether the reactor is adiabatic (no heat flow), isothermal (constant temperature), or diathermal (convective and radiative heat transfer with external media)</p></li>
<li><p><strong>mass_transfer</strong>: whether the reactor is open (mass flow with specified mixing time and inflow stream) or closed (no mass flow)</p></li>
</ul>
<p>Spitfire requires diathermal reactors to have a geometry.
The shape is relevant because it determines ratio of surface area to volume, which plays a role in balancing volumetric heat release due to chemistry against heat transfer across a surface.
The <code class="docutils literal notranslate"><span class="pre">spitfire/demo/reactors/open-reactors-isobaric-diathermal-shapes.py</span></code> example shows the impact of reactor geometry, with high surface areas corresponding to stronger heat loss.</p>
<p>Among the other undiscussed demonstrations, two perform noteworthy analyses.
<code class="docutils literal notranslate"><span class="pre">spitfire/demo/reactors/open-reactors-isobaric-isothermal-with-insitu-processing.py</span></code> gives an example of detailed chemical explosive mode analysis on an isothermal reactor.
<code class="docutils literal notranslate"><span class="pre">spitfire/demo/reactors/open-reactor-oscillatory-convection.py</span></code> involves kinetics, mass transfer (a hot feed stream), and heat transfer (convective losses to a cool fluid) simultaneously.
Furthermore the convection coefficient oscillates in time to cause periodic ignition and extinction.</p>
</div>
</div>
<div class="section" id="non-premixed-flamelets">
<h2>3.4. Non-premixed Flamelets<a class="headerlink" href="#non-premixed-flamelets" title="Permalink to this headline">¶</a></h2>
<p>Spitfire provides a number of convenient methods of solving steady and unsteady nonpremixed flamelets, both adiabatic and nonadiabatic.
A special method is provided for building adiabatic steady flamelet libraries, a common task required for large eddy simulation and flow-resolved direct numerical simulation of combustion systems.
The first demonstration discussed here, in <code class="docutils literal notranslate"><span class="pre">spitfire/demo/flamelet/adiabatic-table-generation.py</span></code>, uses this method to build an adiabiatic flamelet library for a hydrogen-air system.
With the <code class="docutils literal notranslate"><span class="pre">build_adiabatic_slfm_table</span></code> method, we first build a dictionary with a mechanism wrapper, oxidizer and fuel streams (as discussed in prior demonstrations), and specify a pressure and number of grid points to discretize mixture fraction space.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">flamelet_specs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;mech_spec&#39;</span><span class="p">:</span> <span class="n">m</span><span class="p">,</span>
                  <span class="s1">&#39;pressure&#39;</span><span class="p">:</span> <span class="n">pressure</span><span class="p">,</span>
                  <span class="s1">&#39;oxy_stream&#39;</span><span class="p">:</span> <span class="n">air</span><span class="p">,</span>
                  <span class="s1">&#39;fuel_stream&#39;</span><span class="p">:</span> <span class="n">fuel</span><span class="p">,</span>
                  <span class="s1">&#39;grid_points&#39;</span><span class="p">:</span> <span class="mi">34</span><span class="p">}</span>
</pre></div>
</div>
<p>Next we specify the thermochemical quantities and transport properties to compute on the table.
A common set required for flame simulation, which typically requires at least density and viscosity, is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">quantities</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">,</span> <span class="s1">&#39;density&#39;</span><span class="p">,</span> <span class="s1">&#39;mass fraction OH&#39;</span><span class="p">,</span> <span class="s1">&#39;viscosity&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>As in the Python script, we then use the table builder method as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table_coarse</span> <span class="o">=</span> <span class="n">build_adiabatic_slfm_table</span><span class="p">(</span><span class="n">flamelet_specs</span><span class="p">,</span>
                                          <span class="n">quantities</span><span class="p">,</span>
                                          <span class="n">lower_chimax</span><span class="o">=</span><span class="mf">1.e-1</span><span class="p">,</span>
                                          <span class="n">upper_chimax</span><span class="o">=</span><span class="mf">1.e4</span><span class="p">,</span>
                                          <span class="n">n_chimax</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
<p>This particular call specifies the flamelet specifications, tabulated quantities, bounds of the dissipation rate, and the number of dissipation rates to save.
Only six are saved here for the demonstration, while a call shortly afterwards builds a finer table with forty dissipation rates.
The following matplotlib commands in the Python script produce the plots below,
one showing the profiles of each quantity in mixture fraction and the other showing contours on the mixture fraction and dissipation rate space.</p>
<div class="align-center figure" id="id10">
<span id="figure-steady-adiabatic-h2-flamelet-profiles"></span><a class="reference internal image-reference" href="_images/steady_adiabatic_h2_flamelet_profiles.png"><img alt="_images/steady_adiabatic_h2_flamelet_profiles.png" src="_images/steady_adiabatic_h2_flamelet_profiles.png" style="width: 660px;" /></a>
<p class="caption"><span class="caption-number">Fig. 3.5 </span><span class="caption-text">Selected profiles of several quantities over mixture fraction space for steady, adiabatic hydrogen flamelets</span><a class="headerlink" href="#id10" title="Permalink to this image">¶</a></p>
</div>
<div class="align-center figure" id="id11">
<span id="figure-steady-adiabatic-h2-flamelet-contours"></span><a class="reference internal image-reference" href="_images/steady_adiabatic_h2_flamelet_contours.png"><img alt="_images/steady_adiabatic_h2_flamelet_contours.png" src="_images/steady_adiabatic_h2_flamelet_contours.png" style="width: 660px;" /></a>
<p class="caption"><span class="caption-number">Fig. 3.6 </span><span class="caption-text">Contours of several quantities over mixture fraction and dissipation rate space for steady, adiabatic hydrogen flamelets</span><a class="headerlink" href="#id11" title="Permalink to this image">¶</a></p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">build_adiabatic_slfm_table</span></code> method is the simplest option for building adiabatic, steady flamelet libraries.
In the <code class="docutils literal notranslate"><span class="pre">spitfire/demo/flamelet/steady-adiabatic-with-enthalpy-flux.py</span></code> script, we use this function to build two libraries,
computed with or without the consistent enthalpy flux discussed in the theory section.
To enable the flux or not, we simply build the <code class="docutils literal notranslate"><span class="pre">flamelet_specs</span></code> object differently.
This allows a simple observation of the impact of the consistent enthalpy flux formulation on flamelet temperature profiles,
shown here in Figure <a class="reference internal" href="#figure-steady-adiabatic-h2-flamelet-contours"><span class="std std-numref">Fig. 3.6</span></a>.</p>
<div class="align-center figure" id="id12">
<span id="figure-steady-adiabatic-h2-flamelet-profiles-enthalpy-flux"></span><a class="reference internal image-reference" href="_images/steady_adiabatic_h2_flamelet_profiles_enthalpy_flux.png"><img alt="_images/steady_adiabatic_h2_flamelet_profiles_enthalpy_flux.png" src="_images/steady_adiabatic_h2_flamelet_profiles_enthalpy_flux.png" style="width: 660px;" /></a>
<p class="caption"><span class="caption-number">Fig. 3.7 </span><span class="caption-text">Comparison of temperature profiles of steady, adiabiatic hydrogen flamelets for several dissipation rates with and without the consistent enthalpy flux</span><a class="headerlink" href="#id12" title="Permalink to this image">¶</a></p>
</div>
<p>This documentation is in progress… TODO:</p>
<ul class="simple">
<li><p>steady, nonadiabatic demo (quasi steady heat loss)</p></li>
<li><p>make a nonadiabiatic demo with the transient heat loss formulation</p></li>
<li><p>unsteady, adiabatic with cema demo</p></li>
<li><p>steady coal flamelet demo</p></li>
<li><p>jupyter demos - clean up necessary</p></li>
</ul>
</div>
</div>
<div class="section" id="combustion-theory">
<h1>4. Combustion Theory<a class="headerlink" href="#combustion-theory" title="Permalink to this headline">¶</a></h1>
<p>This section details the theory behind Spitfire’s combustion modeling capabilities.
We present the governing equations for homogeneous reactors and non-premixed flamelets
along with the underlying reaction rate laws and thermodynamic property models.</p>
<div class="section" id="governing-equations-for-homogeneous-reactors">
<h2>4.1. Governing Equations for Homogeneous Reactors<a class="headerlink" href="#governing-equations-for-homogeneous-reactors" title="Permalink to this headline">¶</a></h2>
<p>Homogeneous, or ‘zero-dimensional,’ reactor models represent well-mixed combustion systems wherein there are no spatial gradients in any quantity describing the chemical mixture.
In such a system the temperature <span class="math notranslate nohighlight">\(T\)</span>, pressure <span class="math notranslate nohighlight">\(p\)</span>, and composition, expressed by the mass fractions <span class="math notranslate nohighlight">\(\{Y_i\}\)</span>, are all homogeneous and a reactor may be modeled as a point in space whose properties vary only in time, <span class="math notranslate nohighlight">\(t\)</span>.
Zero-dimensional systems are idealizations of very complex systems but have their place in the modeling of combustion processes.
In a lab setting this idealization can be approached with <em>jet-stirred reactors</em> (JSR, also commonly referred to as a continuous stirred tank reactor (CSTR), perfectly stirred reactor (PSR), and Longwell reactor) and <em>rapid compression machines</em> (RCM).
A JSR is a continuous stirred tank reactor to which reactants are fed and mixed rapidly through several opposed jets.
A JSR unit coupled with downstream gas chromatography and mass spectrometry can be used to quantify the composition of the chemical mixture as reaction proceeds.
Detailed models of combustion kinetics are developed through comparison with experimental data from such systems.
The rapid computational solution of kinetic models for simple, zero-dimensional reactors is of great fundamental importance to combustion modeling.</p>
<p>In Spitfire we model mixtures of ideal gases in twelve types of reactors distinguished by their <em>configuration</em>, <em>heat transfer</em>, and <em>mass transfer</em>.
We use <em>configuration</em> to distinguish isochoric, or constant-volume, reactors from isobaric, or constant-pressure, ones.
<em>Mass transfer</em> refers to a closed, or batch, reactor or an open reactor with mass flow at specified mean residence time.
Three types of <em>heat transfer</em> are available:</p>
<ul class="simple">
<li><p>adiabatic: a reactor with insulated walls that allow no heat transfer with the surroundings</p></li>
<li><p>isothermal: a reactor whose temperature is held exactly constant for all time</p></li>
<li><dl class="simple">
<dt>diathermal: a reactor whose walls allow a finite rate of heat transfer by two modes</dt><dd><ul>
<li><p>radiative heat transfer to a nearby surface</p></li>
<li><p>convective heat transfer to a fluid flowing around the reactor</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>Below we detail the equations governing isochoric and isobaric reactors with any pair of models for mass and transfer.
In all cases the ideal gas law applies,</p>
<div class="math notranslate nohighlight" id="equation-ideal-gas-law">
<span class="eqno">(4.1)<a class="headerlink" href="#equation-ideal-gas-law" title="Permalink to this equation">¶</a></span>\[p = \rho R_\mathrm{mix} T,\]</div>
<p>where the mixture specific gas constant, <span class="math notranslate nohighlight">\(R_\mathrm{mix}\)</span>, is the universal molar gas constant divided by the mixture molar mass,</p>
<div class="math notranslate nohighlight" id="equation-mixture-molar-mass">
<span class="eqno">(4.2)<a class="headerlink" href="#equation-mixture-molar-mass" title="Permalink to this equation">¶</a></span>\[M_\mathrm{mix} = \left(\sum_{i=1}^{n}\frac{Y_i}{M_i}\right)^{-1},\]</div>
<p>where <span class="math notranslate nohighlight">\(M_i\)</span> is the molar mass of species <span class="math notranslate nohighlight">\(i\)</span> in a mixture with <span class="math notranslate nohighlight">\(n\)</span> distinct species.
Additionally for all reactors the mass fractions, of which only <span class="math notranslate nohighlight">\(n-1\)</span> are independent, are related by</p>
<div class="math notranslate nohighlight" id="equation-y-n-eqn">
<span class="eqno">(4.3)<a class="headerlink" href="#equation-y-n-eqn" title="Permalink to this equation">¶</a></span>\[Y_n = 1 - \sum_{i=1}^{n-1}Y_i.\]</div>
<div class="section" id="isochoric-reactors">
<h3>4.1.1. Isochoric Reactors<a class="headerlink" href="#isochoric-reactors" title="Permalink to this headline">¶</a></h3>
<p>Figure <a class="reference internal" href="#figure-isochoric-reactor-diagram"><span class="std std-numref">Fig. 4.1</span></a> diagrams an open, constant-volume reactor with diathermal walls.
The reactor has volume <span class="math notranslate nohighlight">\(V\)</span> and surface area <span class="math notranslate nohighlight">\(A\)</span>.
Convective heat transfer is described by a fluid temperature <span class="math notranslate nohighlight">\(T_\infty\)</span> and convective heat transfer coefficient <span class="math notranslate nohighlight">\(h\)</span>.
Radiative heat transfer is determined by the temperature of the surface, <span class="math notranslate nohighlight">\(T_\mathrm{surf}\)</span>, and effective emissivity, <span class="math notranslate nohighlight">\(\varepsilon\)</span>.
Finally, for an isochoric reactor, mass transfer is specified by the residence time <span class="math notranslate nohighlight">\(\tau\)</span>, based on volumetric flow rate, and inflowing state
with temperature <span class="math notranslate nohighlight">\(T_\mathrm{in}\)</span>, density <span class="math notranslate nohighlight">\(\rho_\mathrm{in}\)</span>, and mass fractions <span class="math notranslate nohighlight">\(\{Y_{i,\mathrm{in}}\}\)</span>.</p>
<div class="align-center figure" id="id13">
<span id="figure-isochoric-reactor-diagram"></span><a class="reference internal image-reference" href="_images/isochoric-reactor-diagram.png"><img alt="_images/isochoric-reactor-diagram.png" src="_images/isochoric-reactor-diagram.png" style="width: 660px;" /></a>
<p class="caption"><span class="caption-number">Fig. 4.1 </span><span class="caption-text">Isochoric reactor with mass transfer and convective and radiative heat transfer</span><a class="headerlink" href="#id13" title="Permalink to this image">¶</a></p>
</div>
<p>Isochoric reactors are governed by the following equations for the reactor density, temperature, and first <span class="math notranslate nohighlight">\(n-1\)</span> mass fractions.
<span class="math notranslate nohighlight">\(\omega_i\)</span> is the net mass production rate of species <span class="math notranslate nohighlight">\(i\)</span> due to chemical reactions,
<span class="math notranslate nohighlight">\(c_v\)</span> is the specific, isochoric heat capacity of the mixture,
and <span class="math notranslate nohighlight">\(e_i\)</span> and <span class="math notranslate nohighlight">\(e_{i,\mathrm{in}}\)</span> are the specific internal energy of species <span class="math notranslate nohighlight">\(i\)</span> in the feed and reactor.
<span class="math notranslate nohighlight">\(\sigma\)</span> is the Stefan-Boltzmann constant.
We solve these equations in Spitfire to maximize sparsity and minimize calculation cost of Jacobian matrices.
Recent work <a class="reference internal" href="#mj2018" id="id1"><span>[MJ2018]</span></a> has shown that the conservation error that results from solving a temperature equation instead of an energy equation is negligible when high-order time integration methods such as those in Spitfire are used.
Closed reactors are obtained by setting <span class="math notranslate nohighlight">\(\tau\to\infty\)</span>.
Adiabatic reactors are obtained by setting <span class="math notranslate nohighlight">\(h,\varepsilon\to0\)</span>.
Isothermal reactors are obtained by setting the entire right-hand side of the temperature equation to zero.</p>
<div class="math notranslate nohighlight" id="equation-isochoric-rho-eqn">
<span class="eqno">(4.4)<a class="headerlink" href="#equation-isochoric-rho-eqn" title="Permalink to this equation">¶</a></span>\[\frac{\partial \rho}{\partial t} = \frac{\rho_\mathrm{in} - \rho}{\tau},\]</div>
<div class="math notranslate nohighlight" id="equation-isochoric-yi-eqn">
<span class="eqno">(4.5)<a class="headerlink" href="#equation-isochoric-yi-eqn" title="Permalink to this equation">¶</a></span>\[\frac{\partial Y_i}{\partial t} = \frac{\rho_\mathrm{in}}{\rho}\frac{Y_{i,\mathrm{in}} - Y_i}{\tau} + \frac{\omega_i}{\rho}, \quad i=1,\ldots,n-1\]</div>
<div class="math notranslate nohighlight" id="equation-isochoric-t-eqn">
<span class="eqno">(4.6)<a class="headerlink" href="#equation-isochoric-t-eqn" title="Permalink to this equation">¶</a></span>\[\frac{\partial T}{\partial t} = \frac{\rho_\mathrm{in}}{\rho \tau c_v}\sum_{i=1}^{n}Y_{i,\mathrm{in}}(e_{i,\mathrm{in}} - e_i) - \frac{1}{\rho c_v}\sum_{i=1}^{n}\omega_i e_i + \frac{1}{\rho c_v}\frac{A}{V}\left(h(T_\infty - T) + \varepsilon\sigma(T_\mathrm{surf}^4 - T^4)\right),\]</div>
<dl class="citation">
<dt class="label" id="mj2018"><span class="brackets"><a class="fn-backref" href="#id1">MJ2018</a></span></dt>
<dd><p>Michael A. Hansen, James C. Sutherland,
On the consistency of state vectors and Jacobian matrices,
Combustion and Flame,
Volume 193,
2018,
Pages 257-271,</p>
</dd>
</dl>
</div>
<div class="section" id="isobaric-reactors">
<h3>4.1.2. Isobaric Reactors<a class="headerlink" href="#isobaric-reactors" title="Permalink to this headline">¶</a></h3>
<p>Figure <a class="reference internal" href="#figure-isobaric-reactor-diagram"><span class="std std-numref">Fig. 4.2</span></a> diagrams an open, constant-pressure reactor with diathermal walls.
The pressure, <span class="math notranslate nohighlight">\(p\)</span>, of this reactor is held constant by the motion of a weightless, frictionless piston.
The expansion work done by this process is an important difference between isobaric and isochoric reactors.
We solve the following equations governing isobaric reactors.
<span class="math notranslate nohighlight">\(c_p\)</span> is the specific, isobaric heat capacity of the mixture,
and <span class="math notranslate nohighlight">\(h_i\)</span> and <span class="math notranslate nohighlight">\(h_{i,\mathrm{in}}\)</span> are the specific internal enthalpy of species <span class="math notranslate nohighlight">\(i\)</span> in the feed and reactor.</p>
<div class="math notranslate nohighlight" id="equation-isobaric-yi-eqn">
<span class="eqno">(4.7)<a class="headerlink" href="#equation-isobaric-yi-eqn" title="Permalink to this equation">¶</a></span>\[\frac{\partial Y_i}{\partial t} = \frac{Y_{i,\mathrm{in}} - Y_i}{\tau} + \frac{\omega_i}{\rho}, \quad i=1,\ldots,n-1\]</div>
<div class="math notranslate nohighlight" id="equation-isobaric-t-eqn">
<span class="eqno">(4.8)<a class="headerlink" href="#equation-isobaric-t-eqn" title="Permalink to this equation">¶</a></span>\[\frac{\partial T}{\partial t} = \frac{1}{\tau c_p}\sum_{i=1}^{n}Y_{i,\mathrm{in}}(h_{i,\mathrm{in}} - h_i) - \frac{1}{\rho c_p}\sum_{i=1}^{n}\omega_i h_i + \frac{1}{\rho c_p}\frac{A}{V}\left(h(T_\infty - T) + \varepsilon\sigma(T_\mathrm{surf}^4 - T^4)\right),\]</div>
<div class="align-center figure" id="id14">
<span id="figure-isobaric-reactor-diagram"></span><a class="reference internal image-reference" href="_images/isobaric-reactor-diagram.png"><img alt="_images/isobaric-reactor-diagram.png" src="_images/isobaric-reactor-diagram.png" style="width: 660px;" /></a>
<p class="caption"><span class="caption-number">Fig. 4.2 </span><span class="caption-text">Isobaric reactor with expansion work, mass transfer, and convective and radiative heat transfer</span><a class="headerlink" href="#id14" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>
<div class="section" id="governing-equations-for-non-premixed-flamelets">
<h2>4.2. Governing Equations for Non-premixed Flamelets<a class="headerlink" href="#governing-equations-for-non-premixed-flamelets" title="Permalink to this headline">¶</a></h2>
<p>The unsteady flamelet equations describe the evolution of mass fractions <span class="math notranslate nohighlight">\(Y_i\)</span> and temperature <span class="math notranslate nohighlight">\(T\)</span>
in a Lagrangian time <span class="math notranslate nohighlight">\(t\)</span> and the mixture fraction <span class="math notranslate nohighlight">\(\mathcal{Z}\)</span>.
Equations <a class="reference internal" href="#equation-adiabatic-flamelet-yi-eqn">(4.9)</a> and <a class="reference internal" href="#equation-adiabatic-flamelet-t-eqn">(4.10)</a> govern adiabatic flamelets,
which evolve due to diffusion (with strength proportional the scalar dissipation rate <span class="math notranslate nohighlight">\(\chi\)</span>) and chemistry.
These equations do not account for differential diffusion, which is currently not supported in Spitfire.
The term in the temperature equation with single derivatives in <span class="math notranslate nohighlight">\(\mathcal{Z}\)</span> is not seen in all flamelet
equations as it requires careful derivation.
This term models enthalpy diffusion and is optional in Spitfire (specify <code class="docutils literal notranslate"><span class="pre">include_enthalpy_flux=True</span></code> when building a flamelet object).
Steady flamelets are derived from these equations by simply removing the time term, which leaves the steady flamelet equations
that define the diffusive-reactive balance presumed in the ensemble of thin laminar flames in a turbulent flame (in the flamelet modeling approach).</p>
<div class="math notranslate nohighlight" id="equation-adiabatic-flamelet-yi-eqn">
<span class="eqno">(4.9)<a class="headerlink" href="#equation-adiabatic-flamelet-yi-eqn" title="Permalink to this equation">¶</a></span>\[\frac{\partial Y_i}{\partial t} = \frac{\chi}{2}\frac{\partial^2 Y_i}{\partial \mathcal{Z}^2} + \frac{\omega_i}{\rho},\]</div>
<div class="math notranslate nohighlight" id="equation-adiabatic-flamelet-t-eqn">
<span class="eqno">(4.10)<a class="headerlink" href="#equation-adiabatic-flamelet-t-eqn" title="Permalink to this equation">¶</a></span>\[\frac{\partial T}{\partial t} = \frac{\chi}{2}\left(\frac{\partial^2 T}{\partial \mathcal{Z}^2} + \frac{\partial T}{\partial \mathcal{Z}}\sum_{i=1}^{n}\frac{c_{p,i}}{c_p}\frac{\partial Y_i}{\partial \mathcal{Z}}\right) - \frac{1}{\rho c_p}\sum_{i=1}^{n}\omega_i h_i.\]</div>
<p>These equations are supplemented by boundary conditions defined by the oxidizer and fuel states,</p>
<div class="math notranslate nohighlight" id="equation-combustion-0">
<span class="eqno">(4.11)<a class="headerlink" href="#equation-combustion-0" title="Permalink to this equation">¶</a></span>\[\begin{split}T(t, 0) &amp;= T_{\mathrm{oxy}}, \\
Y_i(t, 0) &amp;= Y_{i,\mathrm{oxy}}, \\
T(t, 1) &amp;= T_{\mathrm{fuel}}, \\
Y_i(t, 1) &amp;= Y_{i,\mathrm{fuel}}.\end{split}\]</div>
<p>The dissipation rate <span class="math notranslate nohighlight">\(\chi\)</span> can be a constant or depend on the mixture fraction as</p>
<div class="math notranslate nohighlight" id="equation-combustion-1">
<span class="eqno">(4.12)<a class="headerlink" href="#equation-combustion-1" title="Permalink to this equation">¶</a></span>\[\chi(\mathcal{Z}) = \chi_{\mathrm{max}} \exp\left( -2\left[\mathrm{erfinv}(2\mathcal{Z}-1)\right]^2 \right).\]</div>
<p>Spitfire also supports nonadiabatic flamelets, which modifies only the temperature equation,</p>
<div class="math notranslate nohighlight" id="equation-nonadiabatic-flamelet-t-eqn">
<span class="eqno">(4.13)<a class="headerlink" href="#equation-nonadiabatic-flamelet-t-eqn" title="Permalink to this equation">¶</a></span>\[\frac{\partial T}{\partial t} = \left.\frac{\partial T}{\partial t}\right|_{\mathrm{adiabatic}} + \frac{1}{\rho c_p}\left(h(T_\infty - T) + \varepsilon\sigma(T_\mathrm{surf}^4 - T^4)\right).\]</div>
<p>Spitfire allows the convection and radiation coefficients and temperatures to vary over the mixture fraction.
A special option for building transient heat loss flamelet libraries involves the following choices
(enabled with <code class="docutils literal notranslate"><span class="pre">use_scaled_heat_loss=True</span></code>).</p>
<div class="math notranslate nohighlight" id="equation-combustion-2">
<span class="eqno">(4.14)<a class="headerlink" href="#equation-combustion-2" title="Permalink to this equation">¶</a></span>\[\begin{split}T_\infty &amp;= T_\mathrm{oxy} + \mathcal{Z}(T_\mathrm{fuel} - T_\mathrm{oxy}), \\
h &amp;= h' \chi_{\mathrm{max}} \frac{1 - \mathcal{Z}_{\mathrm{st}} }{ \mathcal{Z}_{\mathrm{st}} }, \\
\varepsilon &amp;= 0,\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathcal{Z}_{\mathrm{st}}\)</span> is the stoichiometric mixture fraction and
<span class="math notranslate nohighlight">\(h'\)</span> is an arbitrary parameter of order <span class="math notranslate nohighlight">\(10^7\)</span> to drive a flamelet to extinction due to heat loss.</p>
</div>
<div class="section" id="chemical-kinetic-models">
<h2>4.3. Chemical Kinetic Models<a class="headerlink" href="#chemical-kinetic-models" title="Permalink to this headline">¶</a></h2>
<p>Spitfire currently supports various forms of reaction rate expressions for homogeneous gas-phase systems.
Let <span class="math notranslate nohighlight">\(n_r\)</span> be the number of elementary reactions.
The net mass production rate of species <span class="math notranslate nohighlight">\(i\)</span> is then</p>
<div class="math notranslate nohighlight" id="equation-combustion-3">
<span class="eqno">(4.15)<a class="headerlink" href="#equation-combustion-3" title="Permalink to this equation">¶</a></span>\[\omega_i = M_i \sum_{j=1}^{n_r}\nu_{i,j}q_j,\]</div>
<p>where <span class="math notranslate nohighlight">\(\nu_{i,j}\)</span> is the net molar stoichiometric coefficient of species <span class="math notranslate nohighlight">\(i\)</span> in reaction <span class="math notranslate nohighlight">\(j\)</span> and <span class="math notranslate nohighlight">\(q_j\)</span> is the rate of progress of reaction <span class="math notranslate nohighlight">\(j\)</span>.</p>
<p>The rate of progress is decomposed into two parts: first, the mass action component <span class="math notranslate nohighlight">\(\mathcal{R}_j\)</span>, and second, the TBAF component <span class="math notranslate nohighlight">\(\mathcal{C}_j\)</span> which contains third-body enhancement and falloff effects.</p>
<div class="math notranslate nohighlight" id="equation-combustion-4">
<span class="eqno">(4.16)<a class="headerlink" href="#equation-combustion-4" title="Permalink to this equation">¶</a></span>\[q_j = \overset{\text{mass action}}{\mathcal{R}_j}\cdot\overset{\text{3-body + falloff}}{\mathcal{C}_j}.\]</div>
<p>The mass action component consists of forward and reverse rate constants <span class="math notranslate nohighlight">\(k_{f,j}\)</span> and <span class="math notranslate nohighlight">\(k_{r,j}\)</span> along with products of species concentrations <span class="math notranslate nohighlight">\(\left\langle c_k\right\rangle\)</span>,</p>
<div class="math notranslate nohighlight" id="equation-combustion-5">
<span class="eqno">(4.17)<a class="headerlink" href="#equation-combustion-5" title="Permalink to this equation">¶</a></span>\[\mathcal{R}_j = k_{f,j}\prod_{k=1}^{N}\left\langle c_k\right\rangle^{\nu^f_{k,j}} - k_{r,j}\prod_{k=1}^{N}\left\langle c_k\right\rangle^{\nu^r_{k,j}},\]</div>
<p>in which <span class="math notranslate nohighlight">\(\nu^f_{i,j}\)</span> and <span class="math notranslate nohighlight">\(\nu^r_{i,j}\)</span> are the forward and reverse stoichiometric coefficients of species <span class="math notranslate nohighlight">\(i\)</span> in reaction <span class="math notranslate nohighlight">\(j\)</span>, respectively.</p>
<p>The forward rate constant is found with a modified Arrhenius expression,</p>
<div class="math notranslate nohighlight" id="equation-combustion-6">
<span class="eqno">(4.18)<a class="headerlink" href="#equation-combustion-6" title="Permalink to this equation">¶</a></span>\[k_{f,j} = A_j T^{b_j} \exp\left(-\frac{E_{a,j}}{R_u T}\right) = A_j T^{b_j} \exp\left(-\frac{T_{a,j}}{T}\right),\]</div>
<p>where <span class="math notranslate nohighlight">\(A_j\)</span>, <span class="math notranslate nohighlight">\(b_j\)</span>, and <span class="math notranslate nohighlight">\(E_{a,j}\)</span> are the pre-exponential factor, temperature exponent, and activation energy of reaction <span class="math notranslate nohighlight">\(j\)</span>, respectively.
We define <span class="math notranslate nohighlight">\(T_{a,j}=E_{a,j}/R_u\)</span> as the <a href="#id2"><span class="problematic" id="id3">`</span></a>activation temperature.’</p>
<p>The reverse rate constant of an irreversible reaction is zero.
<span class="math notranslate nohighlight">\(k_{r,j}\)</span> for a reversible reaction is found with the equilibrium constant <span class="math notranslate nohighlight">\(K_{c,j}\)</span>, via <span class="math notranslate nohighlight">\(k_{r,j} = k_{f,j}/K_{c,j}\)</span>.
The equilibrium constant is</p>
<div class="math notranslate nohighlight" id="equation-combustion-7">
<span class="eqno">(4.19)<a class="headerlink" href="#equation-combustion-7" title="Permalink to this equation">¶</a></span>\[K_{c,j} = \left(\frac{p_\text{atm}}{R_u}\right)^{\Xi_j}\exp\left(\sum_{k=1}^{N}\nu_{k,j}B_k\right),\]</div>
<p>where <span class="math notranslate nohighlight">\(\Xi_j=\sum_{k=1}^{N}\nu_{k,j}\)</span> and <span class="math notranslate nohighlight">\(B_k\)</span> is</p>
<div class="math notranslate nohighlight" id="equation-combustion-8">
<span class="eqno">(4.20)<a class="headerlink" href="#equation-combustion-8" title="Permalink to this equation">¶</a></span>\[B_k = -\ln(T) + \frac{M_k}{R_u}\left(s_k - \frac{h_k}{T}\right).\]</div>
<p>For the TBAF component <span class="math notranslate nohighlight">\(\mathcal{C}_j\)</span> there are two nontrivial cases: (1) a three-body reaction and, (2) a unimolecular/recombination falloff reaction.
If a reaction is not of a three-body or falloff type, then <span class="math notranslate nohighlight">\(\mathcal{C}_j = 1\)</span>.
For three-body reactions, it is</p>
<div class="math notranslate nohighlight" id="equation-combustion-9">
<span class="eqno">(4.21)<a class="headerlink" href="#equation-combustion-9" title="Permalink to this equation">¶</a></span>\[\mathcal{C}_j = \left\langle c_{TB,j}\right\rangle = \sum_{i=1}^{N}\alpha_{i,j}\left\langle c_i\right\rangle,\]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha_{i,j}\)</span> is the third-body enhancement factor of species <span class="math notranslate nohighlight">\(i\)</span> in reaction <span class="math notranslate nohighlight">\(j\)</span>, and <span class="math notranslate nohighlight">\(\left\langle c_{TB,j}\right\rangle\)</span> is the third-body-enhanced concentration of reaction <span class="math notranslate nohighlight">\(j\)</span>.
The quantity <span class="math notranslate nohighlight">\(\alpha_{i,j}\)</span> defaults to one if not specified.
For falloff reactions, the TBAF component is</p>
<div class="math notranslate nohighlight" id="equation-combustion-10">
<span class="eqno">(4.22)<a class="headerlink" href="#equation-combustion-10" title="Permalink to this equation">¶</a></span>\[\mathcal{C}_j = \frac{p_{fr,j}}{1 + p_{fr,j}}\mathcal{F}_j,\]</div>
<p>in which <span class="math notranslate nohighlight">\(p_{fr,j}\)</span> and <span class="math notranslate nohighlight">\(\mathcal{F}_j\)</span> are the falloff reduced pressure and falloff blending factor, respectively.
The falloff reduced pressure is</p>
<div class="math notranslate nohighlight" id="equation-combustion-11">
<span class="eqno">(4.23)<a class="headerlink" href="#equation-combustion-11" title="Permalink to this equation">¶</a></span>\[p_{fr,j} = \frac{k_{0,j}}{k_{f,j}}\mathcal{T}_{F,j},\]</div>
<p>where <span class="math notranslate nohighlight">\(k_{0,j}\)</span> is the low-pressure limit rate constant evaluated with low-pressure Arrhenius parameters <span class="math notranslate nohighlight">\(A_{0,j}\)</span>, <span class="math notranslate nohighlight">\(b_{0,j}\)</span>, <span class="math notranslate nohighlight">\(E_{a,0,j}\)</span>, and <span class="math notranslate nohighlight">\(\mathcal{T}_{F,j}\)</span> is the <a href="#id4"><span class="problematic" id="id5">`</span></a>concentration’ of the mixture
which is either that of a single species if specified or the third-body-enhanced concentration if not.</p>
<p>The falloff blending factor <span class="math notranslate nohighlight">\(\mathcal{F}_j\)</span> depends upon the specified falloff form.
For the Lindemann approach, <span class="math notranslate nohighlight">\(\mathcal{F}_j = 1\)</span>.
In the Troe form,</p>
<div class="math notranslate nohighlight" id="equation-combustion-12">
<span class="eqno">(4.24)<a class="headerlink" href="#equation-combustion-12" title="Permalink to this equation">¶</a></span>\[\begin{split}\mathcal{F}_j &amp;= \mathcal{F}_{\text{cent}}^{1/(1+(A/B)^2)}, \\
\mathcal{F}_{\text{cent}} &amp;= (1-a_{\text{Troe}})\exp\left(-\frac{T}{T^{***}}\right) + a_{\text{Troe}}\exp\left(-\frac{T}{T^{*}}\right) + \exp\left(-\frac{T^{**}}{T}\right), \\
A &amp;= \log_{10}p_{FR,j} - 0.67\log_{10}\mathcal{F}_{\text{cent}} - 0.4, \\
B &amp;= 0.806 - 1.1762\log_{10}\mathcal{F}_{\text{cent}} - 0.14\log_{10}p_{FR,j},\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(a_{\text{Troe}}\)</span>, <span class="math notranslate nohighlight">\(T^{*}\)</span>, <span class="math notranslate nohighlight">\(T^{**}\)</span>, and <span class="math notranslate nohighlight">\(T^{***}\)</span> are specified parameters of the Troe form.
If <span class="math notranslate nohighlight">\(T^{***}\)</span> is unspecified in the mechanism file then its term is ignored.</p>
</div>
<div class="section" id="species-thermodynamics">
<h2>4.4. Species Thermodynamics<a class="headerlink" href="#species-thermodynamics" title="Permalink to this headline">¶</a></h2>
<p>Spitfire supports thermodynamics (enthalpies, entropies, equilibrium coefficients, etc.) based on two models of
species heat capacities.
First is a species with a constant heat capacity:</p>
<div class="math notranslate nohighlight" id="equation-combustion-13">
<span class="eqno">(4.25)<a class="headerlink" href="#equation-combustion-13" title="Permalink to this equation">¶</a></span>\[\begin{split}c_{p,i} &amp;= c_{p,i}^\circ, \\
h_i &amp;= h_i^\circ + c_{p,i}^\circ(T - T^\circ), \\
s_i &amp;= s_i^\circ + c_{p,i}^\circ\ln\left(\frac{T}{T^\circ}\right),\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(h_i^\circ\)</span> and <span class="math notranslate nohighlight">\(s_i^\circ\)</span> are the standard state enthalpy and entropy of formation.</p>
<p>Second is a species with a variable heat capacity determined by the NASA-7 polynomials:</p>
<div class="math notranslate nohighlight" id="equation-combustion-14">
<span class="eqno">(4.26)<a class="headerlink" href="#equation-combustion-14" title="Permalink to this equation">¶</a></span>\[\begin{split}c_{p,i} &amp;= \frac{R_u}{M_i}\left(a_0 + a_1T + a_2T^2 + a_3T^3 + a_4T^4\right), \\
h_i &amp;= \frac{R_u}{M_i}\left(a_0T + \frac{a_1}{2}T^2 + \frac{a_2}{3}T^3 + \frac{a_3}{4}T^4 + \frac{a_4}{5}T^5 + a_5\right), \\
s_i &amp;= \frac{R_u}{M_i}\left(a_0\ln(T) + a_1T + \frac{a_2}{2}T^2 + \frac{a_3}{3}T^3 + \frac{a_4}{4}T^4 + a_6\right),\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(a_i\)</span> are the coefficients of the polynomial (in a particular temperature range) and <span class="math notranslate nohighlight">\(R_u\)</span> is the universal molar gas constant.</p>
</div>
</div>


      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        «&#160;&#160;<a href="timeintegration.html">2. Time Integration</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="modules.html">5. spitfire</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2018-2019.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.1.2.
    </div>
  </body>
</html>